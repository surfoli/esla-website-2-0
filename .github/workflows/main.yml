name: Auto Merge Codex PRs

on:
  pull_request:
    types: [opened, reopened, synchronize]

jobs:
  auto-merge:
    runs-on: ubuntu-latest
    if: github.actor == 'chatgpt-codex-connector[bot]' || startsWith(github.head_ref, 'codex/')
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Merge PR
        uses: pascalgn/automerge-action@v0.15.6
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          MERGE_METHOD: squash
          MERGE_COMMIT_MESSAGE: "ðŸ¤– Auto-merged Codex PR: ${{ github.head_ref }}"
          MERGE_DELETE_BRANCH: true
